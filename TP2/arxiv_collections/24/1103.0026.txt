We present Hubble Space Telescope optical and near-ultraviolet transmission
spectra of the transiting hot-Jupiter HD189733b, taken with the repaired Space
Telescope Imaging Spectrograph (STIS) instrument. The resulting spectra cover
the range 2900-5700 Ang and reach per-exposure signal-to-noise levels greater
than 11,000 within a 500 Ang bandwidth. We used time series spectra obtained
during two transit events to determine the wavelength dependance of the
planetary radius and measure the exoplanet's atmospheric transmission spectrum
for the first time over this wavelength range. Our measurements, in conjunction
with existing HST spectra, now provide a broadband transmission spectrum
covering the full optical regime. The STIS data also shows unambiguous evidence
of a large occulted stellar spot during one of our transit events, which we use
to place constraints on the characteristics of the K dwarf's stellar spots,
estimating spot temperatures around Teff~4250 K. With contemporaneous
ground-based photometric monitoring of the stellar variability, we also measure
the correlation between the stellar activity level and transit-measured
planet-to-star radius contrast, which is in good agreement with predictions. We
find a planetary transmission spectrum in good agreement with that of Rayleigh
scattering from a high-altitude atmospheric haze as previously found from HST
ACS camera. The high-altitude haze is now found to cover the entire optical
regime and is well characterised by Rayleigh scattering. These findings suggest
that haze may be a globally dominant atmospheric feature of the planet which
would result in a high optical albedo at shorter optical wavelengths.