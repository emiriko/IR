We have developed a multi-orbital approach to compute the electronic
structure of a quantum impurity using the non-crossing approximation. The
calculation starts with a mean-field evaluation of the system's electronic
structure using a standard quantum chemistry code. Here we use density
functional theory (DFT). We transformed the one-electron structure into an
impurity Hamiltonian by using maximally localized Wannier functions (MLWF).
Hence, we have developed a method to study the Kondo effect in systems based on
an initial one-electron calculation. We have applied our methodology to a
copper phthalocyanine molecule chemisorbed on Ag (100), and we have described
its spectral function for three different cases where the molecule presents a
single spin or two spins with ferro- and anti-ferromagnetic exchange couplings.
We find that the use of broken-symmetry mean-field theories such as Kohn-Sham
DFT cannot deal with the complexity of the spin of open-shell molecules on
metal surfaces and extra modeling is needed.