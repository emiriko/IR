The band-gap problem and other systematic failures of approximate functionals
are explained from an analysis of total energy for fractional charges. The
deviation from the correct intrinsic linear behavior in finite systems leads to
delocalization and localization errors in large or bulk systems. Functionals
whose energy is convex for fractional charges such as LDA display an incorrect
apparent linearity in the bulk limit, due to the delocalization error. Concave
functionals also have an incorrect apparent linearity in the bulk calculation,
due to the localization error and imposed symmetry. This resolves an important
paradox and opens the possibility to obtain accurate band-gaps from DFT.