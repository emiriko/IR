An algorithm, based on numerical description of the terms of many-body
perturbation theory (Goldstone diagrams), is presented. The algorithm allows
the use of the same piece of computer code to evaluate any particular diagram
in any specific order of the perturbation theory or to calculate similar terms
in other areas of the many-body theory, like e.g. terms in the coupled-cluster
equations. The use of the algorithm is illustrated by calculating the second
and third order correlation corrections to the removal energies of electrons
from the ground state of sodium, copper and gallium and by calculating the
hyperfine structure constants of sodium in the linearized single-double coupled
cluster approximation.