A passive scheme with a beam splitter and a photon-number-resolving (PNR)
detector is proposed to verify the photon statistics of an untrusted source in
a plug-and-play quantum-key-distribution system by applying a three-intensity
decoy-state protocol. The practical issues due to statistical fluctuation and
detection noise are analyzed. The simulation results show that the scheme can
work efficiently when the total number of optical pulses sent from Alice to Bob
is above 10^8, and the dark count rate of the PNR detector is below 0.5
counts/pulse, which is realizable with current techniques. Furthermore, we
propose a practical realization of the PNR detector with a variable optical
attenuator combined with a threshold detector.