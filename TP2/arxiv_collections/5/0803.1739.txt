We determine the symmetry of Cooper pairs, on the basis of the perturbation
theory in terms of the Coulomb interaction $U$, for the two-dimensional Hubbard
model on the square lattice. The phase diagram is investigated in detail. The
Hubbard model for small $U$ is mapped onto an effective Hamiltonian with the
attractive interaction using the canonical transformation: $H_{eff}=e^S
He^{-S}$. The gap equation of the weak coupling formulation is solved without
numerical ambiguity to determine the symmetry of Cooper pairs. The
superconducting gap crucially depends on the position of the van Hove
singularity. We show the phase diagram in the plane of the electron filling
$n_e$ and the next nearest-neighbor transfer $t'$. The d-wave pairing is
dominant for the square lattice in a wide range of $n_e$ and $t'$. The d-wave
pairing is also stable for the square lattice with anisotropic $t'$. The
three-band $d$-$p$ model is also investigated, for which the d-wave pairing is
stable in a wide range of $n_e$ and $t_{pp}$ (the transfer between neighboring
oxygen atoms). In the weak coupling analysis, the second-neighbor transfer
parameter $-t'$ could not be so large so that the optimum doping rate is in the
range of $0.8 <n_e <0.9$.