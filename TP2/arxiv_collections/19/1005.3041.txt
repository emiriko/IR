Recent studies have shown that galaxies accrete most of their baryons via the
cold mode, from streams with temperatures T~10^4-10^5 K. At these temperatures,
the streams should radiate primarily in the Lya line and have therefore been
proposed as a model to power the extended, high-redshift objects known as Lya
blobs and other high-redshift Lya sources. We introduce a new Lya radiative
transfer code, aRT, and apply it to cosmological hydrodynamical simulations. We
address physical and numerical issues that are critical to making accurate
predictions for the cooling luminosity, but that have been mostly neglected or
treated simplistically so far. We highlight the importance of self-shielding
and of properly treating sub-resolution models in simulations. Most existing
simulations do not self-consistently incorporate these effects, which can lead
to order-of-magnitude errors in the predicted cooling luminosity. Using a
combination of post-processing ionizing radiative transfer and re-simulation
techniques, we develop an approximation to the consistent evolution of the
self-shielded gas. We quantify the dependence of the Lya cooling luminosity on
halo mass at z=3 for the simplified problem of pure gas accretion. While
cooling in massive halos (without additional energy input from star formation
and AGN) is in principle sufficient to produce L_alpha~10^43-10^44 erg s^-1
blobs, this requires including energy released in gas of density sufficient to
form stars, but which is kept 100% gaseous in our optimistic estimates.
Excluding emission from such dense gas yields lower luminosities by up to one
to two orders of magnitude at high masses, making it difficult to explain the
observed Lya blobs with pure cooling. Resonant scattering produces diffuse Lya
halos, even for centrally concentrated emission, and broad double peaked line
profiles. [Abridged]