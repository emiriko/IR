We present a first-principles method for calculating the charging energy of a
molecular single-electron transistor operating in the Coulomb blockade regime.
The properties of the molecule are modeled using density-functional theory, the
environment is described by a continuum model, and the interaction between the
molecule and the environment are included through the Poisson equation. The
model is used to calculate the charge stability diagrams of a benzene and
C$_{60}$ molecular single-electron transistor.