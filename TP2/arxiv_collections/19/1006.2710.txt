Extended Lagrangian Born-Oppenheimer molecular dynamics [Niklasson, Phys.
Rev. Lett. 100 123004 (2008)] has been generalized to the propagation of the
electronic wavefunctions. The technique allows highly efficient first
principles molecular dynamics simulations using plane wave pseudopotential
electronic structure methods that are stable and energy conserving also under
incomplete and approximate self-consistency convergence. An implementation of
the method within the planewave basis set is presented and the accuracy and
efficiency is demonstrated both for semi-conductor and metallic materials.