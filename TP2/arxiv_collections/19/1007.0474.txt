We have developed an algorithm that, starting from the observed properties of
the X-ray spectrum and fast variability of an X-ray binary allows the
production of synthetic data reproducing observables such as power density
spectra and time lags, as well as their energy dependence. This allows to
reconstruct the variability of parameters of the energy spectrum and to reduce
substantially the effects of Poisson noise, allowing to study fast spectral
variations. We have applied the algorithm to Rossi X-ray Timing Explorer data
of the black-hole binary Cygnus X-1, fitting the energy spectrum with a
simplified power law model. We recovered the distribution of the power law
spectral indices on time-scales as low as 62 ms as being limited between 1.6
and 1.8. The index is positively correlated with the flux even on such
time-scales.