We study the impact of ultraviolet background (UVB) radiation field and the
local stellar radiation on the H_I column density distribution f(N_HI) of
damped Ly-alpha systems (DLAs) and sub-DLAs at z=3 using cosmological smoothed
particle hydrodynamics simulations. We find that, in the previous simulations
with an optically thin approximation, the UVB was sinking into the H_I cloud
too deeply, and therefore we underestimated the f(N_HI) at 19 < log(N_HI) <
21.2 compared to the observations. If the UVB is shut off in the high-density
regions with n_gas > 6 x 10^{-3} cm^{-3}, then we reproduce the observed
f(N_HI) at z=3 very well. We also investigate the effect of local stellar
radiation by post-processing our simulation with a radiative transfer code, and
find that the local stellar radiation does not change the f(N_HI) very much.
Our results show that the shape of f(N_HI) is determined primarily by the UVB
with a much weaker effect by the local stellar radiation and that the optically
thin approximation often used in cosmological simulation is inadequate to
properly treat the ionization structure of neutral gas in and out of DLAs. Our
result also indicates that the DLA gas is closely related to the transition
region from optically-thick neutral gas to optically-thin ionized gas within
dark matter halos.