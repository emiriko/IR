Knowledge-based programs provide an abstract level of description of
protocols in which agent actions are related to their states of knowledge. The
paper describes how epistemic model checking technology may be applied to
discover and verify concrete implementations based on this abstract level of
description. The details of the implementations depend on the specific context
of use of the protocol. The knowledge-based approach enables the
implementations to be optimized relative to these conditions of use. The
approach is illustrated using extensions of the Dining Cryptographers protocol,
a security protocol for anonymous broadcast.