We derive an exact non-Markovian master equation that generalizes the
previous work [Hu, Paz and Zhang, Phys. Rev. D {\bf 45}, 2843 (1992)] to damped
harmonic oscillators with time-varying parameters. This is achieved by
exploiting the linearity of the system and operator solution in Heisenberg
picture. Our equation governs the non-Markovian quantum dynamics when the
system is modulated by external devices. As an application, we apply our
equation to parity kick decoupling problems. The time-dependent dissipative
coefficients in the master equation are shown to be modified drastically when
the system is driven by $\pi$ pulses. For coherence protection to be effective,
our numerical results indicate that kicking period should be shorter than
memory time of the bath. The effects of using soft pulses in an ohmic bath are
also discussed.