First, we establish the relation between the associated varieties of modules
over Kac-Moody algebras \hat{g} and those over affine W-algebras. Second, we
prove the Feigin-Frenkel conjecture on the singular supports of G-integrable
admissible representations. In fact we show that the associated variates of
G-integrable admissible representations are irreducible G-invariant
subvarieties of the nullcone of g, by determining them explicitly. Third, we
prove the C_2-cofiniteness of a large number of simple W-algebras, including
all minimal series principal W-algebras and the exceptional W-algebras recently
discovered by Kac-Wakimoto.