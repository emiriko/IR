We prove an extension theorem for effective plt pairs $(X,S+B)$ of
non-negative Kodaira dimension $\kappa (K_X+S+B)\geq 0$. The main new
ingredient is a refinement of the Ohsawa-Takegoshi $L^2$ extension theorem
involving singular hermitian metrics.