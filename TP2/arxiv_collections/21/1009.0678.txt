We construct an isomorphism between the (universal) spherical Hall algebra of
a smooth projective curve of genus g and a convolution algebra in the
(equivariant) K-theory of the genus g commuting varieties C_{{gl}_r}={(x_i,
y_i) \in {gl}_r^{2g}; \sum_{i=1}^g [x_i,y_i]=0}. We can view this isomorphism
as a version of the geometric Langlands duality in the formal neighborhood of
the trivial local system, for the group GL_r. We extend this to all reductive
groups and we compute the image, under our correspondence, of the skyscraper
sheaf supported on the trivial local system.