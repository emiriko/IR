In prokaryotic genomes the number of transcriptional regulators is known to
quadratically scale with the total number of protein-coding genes. Toolbox
model was recently proposed to explain this scaling for metabolic enzymes and
their regulators. According to its rules the metabolic network of an organism
evolves by horizontal transfer of pathways from other species. These pathways
are part of a larger "universal" network formed by the union of all
species-specific networks. It remained to be understood, however, how the
topological properties of this universal network influence the scaling law of
functional content of genomes. In this study we answer this question by first
analyzing the scaling properties of the toolbox model on arbitrary tree-like
universal networks. We mathematically prove that the critical branching
topology, in which the average number of upstream neighbors of a node is equal
to one, is both necessary and sufficient for the quadratic scaling. Conversely,
the toolbox model on trees with exponentially expanding, supercritical topology
is characterized by the linear scaling with logarithmic corrections. We further
generalize our model to include reactions with multiple substrates/products as
well as branched or cyclic metabolic pathways. Unlike the original model the
new version employs evolutionary optimized pathways with the smallest number of
reactions necessary to achieve their metabolic tasks. Numerical simulations of
this most realistic model on the universal network from the KEGG database again
produced approximately quadratic scaling. Our results demonstrate why, in spite
of their "small-world" topology, real-life metabolic networks are characterized
by a broad distribution of pathway lengths and sizes of metabolic regulons in
regulatory networks.