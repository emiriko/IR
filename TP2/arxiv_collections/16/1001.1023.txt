A new formulation of the stochastic potential switching algorithm is
presented. This reformulation naturally leads us to a generalized
Fourtuin-Kasteleyn representation of the partition function Z. A formula for
internal energy E and that of heat capacity C are derived from derivatives of
the partition function. We also derive a formula for the exchange probability
in the replica exchange Monte Carlo method. By combining the formulae with the
Stochastic Cutoff method, we can greatly reduce the computational time to
perform internal energy and heat capacity measurements and the replica exchange
Monte Carlo method in long-range interacting systems. Numerical simulations in
three dimensional magnetic dipolar systems show the validity and efficiency of
the method.