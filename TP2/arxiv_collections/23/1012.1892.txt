We calculate high-harmonic generation (HHG) by intense infrared lasers in
atoms and molecules with the inclusion of macroscopic propagation of the
harmonics in the gas medium. We show that the observed experimental spectra can
be accurately reproduced theoretically despite that HHG spectra are sensitive
to the experimental conditions. We further demonstrate that the simulated (or
experimental) HHG spectra can be factored out as a product of a \macroscopic
wave packet" and the photo-recombination transition dipole moment where the
former depends on the laser properties and the experimental conditions, while
the latter is the property of the target only. The factorization makes it
possible to extract target structure from experimental HHG spectra, and for
ultrafast dynamic imaging of transient molecules.