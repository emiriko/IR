Hollow-core photonic-crystal waveguides filled with cold atoms can support
giant optical nonlinearities through nondispersive propagation of light tightly
confined in the transverse direction. Here we explore electromagnetically
induced transparency is such structures, considering a pair of
counter-propagating weak quantum fields in the medium of coherently driven
atoms in the ladder configuration. Strong dipole--dipole interactions between
optically excited, polarized Rydberg states of the atoms translate into a large
dispersive interaction between the two fields. This can be used to attain a
spatially-homogeneous conditional phase shift of pi for two single-photon
pulses, realizing a deterministic photonic phase gate, or to implement a
quantum nondemolition measurement of the photon number in the signal pulse by a
coherent probe, thereby achieving a heralded source of single or few photon
pulses.