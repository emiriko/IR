We construct a unified covariant derivative that contains the sum of an
affine connection and a Yang-Mills field. With it we construct a lagrangian
that is invariant both under diffeomorphisms and Yang-Mills gauge
transformations. We assume that metric and symmetric affine connection are
independent quantities, and make the observation that the metric must be able
to generate curvature, just as the connection, so there should be an extra
tensor similar to Riemann's in the equations but constructed from metrics and
not connections. We find the equations generated by the lagrangian and
introduce the huge natural scale due to the vacuum energy of quantum fields.
This scale allows for a perturbative solution of the equations of motion. We
prove the system has a vacuum state that forces the metricity of the metric and
results in General Relativity for low energies. The vacuum energy of the
quantum fields cancels, becoming unobservable. At very high energies, the
metric does not appear differentiated in the lagrangian and so it is not a
quantum field, just a background classical field. The true quantum fields are
the connections. The theory becomes very similar to a Yang-Mills, with affine
connections taking the place of Yang-Mills vector fields. It should be
renormalizable since it has a coupling constant with no units and correct
propagators after fixing the gauge (diffeomorphisms). The weakness of gravity
turns out to be due to the large vacuum energy of the quantum fields.