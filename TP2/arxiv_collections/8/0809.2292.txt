Conventional quantum chemical solvation theories are based on the mean-field
embedding approximation. That is, the electronic wavefunction is calculated in
the presence of the mean field of the environment. In this paper a direct
quantum mechanical/molecular mechanical (QM/MM) analog of such a mean-field
theory is formulated based on variational and perturbative frameworks. In the
variational framework, an appropriate QM/MM free energy functional is defined
and is minimized in terms of the trial wavefunction that best approximates the
true QM wavefunction in a statistically averaged sense. Analytical free energy
gradient is obtained, which takes the form of the gradient of effective QM
energy calculated in the averaged MM potential. In the perturbative framework,
the above variational procedure is shown to be equivalent with the first-order
expansion of the QM energy (in the exact free energy expression) about the
self-consistent reference field. This helps understand the relation between the
variational procedure and the exact QM/MM free energy as well as existing QM/MM
theories. Based on this, several ways are discussed for evaluating
non-mean-field effects (i.e., statistical fluctuations of the QM wavefunction)
that are neglected in the mean-field calculation. As an illustration, the
method is applied to an SN2 Menshutkin reaction in water, NH3 + CH3CL ->
NH3CH3^{+} + CL^{-}, for which free energy profiles are obtained at the HF,
MP2, B3LYP, and BH&HLYP levels by integrating the free energy gradient.
Non-mean-field effects are evaluated to be < 0.5 kcal/mol using a Gaussian
fluctuation model for the environment, which suggests that those effects are
rather small for the present reaction in water.