We study the interaction between geometric operations on stacks and algebraic
operations on their categories of sheaves. We work in the general setting of
derived algebraic geometry: our basic objects are derived stacks X and their
oo-categories QC(X) of quasicoherent sheaves. We show that for a broad class of
derived stacks, called perfect stacks, algebraic and geometric operations on
their categories of sheaves are compatible. We identify the category of sheaves
on a fiber product with the tensor product of the categories of sheaves on the
factors. We also identify the category of sheaves on a fiber product with
functors between the categories of sheaves on the factors (thus realizing
functors as integral transforms, generalizing a theorem of Toen for ordinary
schemes). As a first application, for a perfect stack X, consider QC(X) with
its usual monoidal tensor product. Then our main results imply the equivalence
of the Drinfeld center (or Hochschild cohomology category) of QC(X), the trace
(or Hochschild homology category) of QC(X) and the category of sheaves on the
loop space of X. More generally, we show that the E_n-center and the E_n-trace
(or E_n-Hochschild cohomology and homology categories respectively) of QC(X)
are equivalent to the category of sheaves on the space of maps from the
n-sphere into X. This directly verifies geometric instances of the categorified
Deligne and Kontsevich conjectures on the structure of Hochschild cohomology.
As a second application, we use our main results to calculate the Drinfeld
center of categories of linear endofunctors of categories of sheaves. This
provides concrete applications to the structure of Hecke algebras in geometric
representation theory. Finally, we explain how all of the above results can be
interpreted in the context of topological field theory.