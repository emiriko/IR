We derive a microscopic expression for the instantaneous diagonal elements of
the density matrix $\rho_{nn}(t)$ in the adiabatic basis for an arbitrary time
dependent process in a closed Hamiltonian system. If the initial density matrix
is stationary (diagonal) then this expression contains only squares of absolute
values of matrix elements of the evolution operator, which can be interpreted
as transition probabilities. We then derive the microscopic expression for the
heat defined as the energy generated due to transitions between instantaneous
energy levels. If the initial density matrix is passive (diagonal with
$\rho_{nn}(0)$ monotonically decreasing with energy) then the heat is
non-negative in agreement with basic expectations of thermodynamics. Our
findings also can be used for systematic expansion of various observables
around the adiabatic limit.