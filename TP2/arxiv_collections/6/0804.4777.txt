Thin films of Co/Ru(0001) are known to exhibit an unusual spin reorientation
transition (SRT) coupled to the completion of Co atomic layers for Co
thicknesses under 4 layers. By means of spin-polarized low-energy electron
microscopy, we follow in real space the magnetization orientation during the
growth of atomically thick capping layers on Co/Ru(0001). Capping with
coinage-metal (Cu, Ag, Au) elements modifies the SRT depending on the Co and
overlayer thickness and on the overlayer material, resulting in an expanded
range of structures with high perpendicular magnetic anisotropy. The origin of
the SRT can be explained in terms of ab-initio calculations of the
layer-resolved contributions to the magnetic anisotropy energy. Besides the
changes in the SRT introduced by the capping, a quantitative enhancement of the
magnetic anisotropy is identified. A detailed analysis of the interplay between
strain and purely electronic effects allows us to identify the conditions that
lead to a high perpendicular magnetic anisotropy in thin hcp Co films.