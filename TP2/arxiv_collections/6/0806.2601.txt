The partition function of a quantum field theory with an exact symmetry can
be decomposed into a sum of functional integrals each giving the contribution
from states with definite symmetry properties. The composition rules of the
corresponding transfer matrix elements can be exploited to devise a multi-level
Monte Carlo integration scheme for computing correlation functions whose
numerical cost, at a fixed precision and at asymptotically large times,
increases power-like with the time extent of the lattice. As a result the
numerical effort is exponentially reduced with respect to the standard Monte
Carlo procedure. We test this strategy in the SU(3) Yang--Mills theory by
evaluating the relative contribution to the partition function of the parity
odd states.