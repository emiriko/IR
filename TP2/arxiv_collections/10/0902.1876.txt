We present a new formal solution of the Lagrangian equation of radiative
transfer that is useful in solving the equation of radiative transfer in the
presence of arbitrary velocity fields. Normally a term due to the inclusion of
the wavelength derivative in the Lagrangian equation of radiative transfer is
associated with a generalised opacity. In non-monotonic velocity fields, this
generalised opacity may become negative. To ensure that the opacity remains
positive, this term of the derivative is included in the formal solution of the
radiative transfer problem.
  The new definition of the generalised opacity allows for a new solution of
the equation of radiative transfer in the presence of velocity fields. It is
especially useful for arbitrary velocity fields, where it effectively prevents
the occurrences of negative generalised opacities and still allows the explicit
construction of the Lambda-operator of the system needed for an accelerated
Lambda-iteration. We performed test calculations, where the results of old,
established solutions were compared with the new solution. The relative
deviations never exceeded 1% and so the new solution is indeed suitable for use
in radiative-transfer modelling. Non-monotonic velocity fields along photon
paths frequently occur in three-dimensional hydrodynamical models of
astrophysical atmospheres. Therefore, the formal solution will be of use for
multidimensional radiative transfer and has immediate applications in the
modelling of pulsating stars and astrophysical shock fronts.