We study some non-highest weight modules over an affine Kac-Moody algebra at
non-critical level. Roughly speaking, these modules are non-commutative
localizations of some non-highest weight "vacuum" modules. Using free field
realization, we embed some rings of differential operators in endomorphism
rings of our modules.
  These rings of differential operators act on a localization of the space of
coinvariants of any module over the Kac-Moody algebra with respect to a certain
level subalgebra. In a particular case this action is identified with the
Casimir connection.