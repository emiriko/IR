We define a regularized theta lift from SL_2 to orthogonal groups over
totally real fields. It takes harmonic `Whittaker forms' to automorphic Green
functions and weakly holomorphic Whittaker forms to meromorphic modular forms
on orthogonal groups with zeros and poles supported on special divisors,
generalizing Borcherds' work on automorphic products. To prove our results we
use the spectral expansion of the lift and study its relationship with the
cohomological theta lift of Kudla and Millson.