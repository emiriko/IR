Some functions entering cosmological analysis, such as the dark energy
equation of state or systematic uncertainties, are unknown functions of
redshift. To include them without assuming a particular form we derive an
efficient method for generating realizations of all possible functions subject
to certain bounds or physical conditions, e.g. w\in[-1,+1] as for quintessence.
The method is optimal in the sense that it is both pure and complete in filling
the allowed space of principal components. The technique is applied to
propagation of systematic uncertainties in supernova population drift and dust
corrections and calibration through to cosmology parameter estimation and bias
in the magnitude-redshift Hubble diagram. We identify specific ranges of
redshift and wavelength bands where the greatest improvements in supernova
systematics due to population evolution and dust correction can be achieved.