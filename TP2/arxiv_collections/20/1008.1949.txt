We develop a combinatorial model of networks on orientable surfaces, and
study weight and homology generating functions of paths and cycles in these
networks. Network transformations preserving these generating functions are
investigated.
  We describe in terms of our model the crystal structure and R-matrix of the
affine geometric crystal of products of symmetric and dual symmetric powers of
type A. Local realizations of the R-matrix and crystal actions are used to
construct a double affine geometric crystal on a torus, generalizing the
commutation result of Kajiwara-Noumi-Yamada and an observation of
Berenstein-Kazhdan.
  We show that our model on a cylinder gives a decomposition and
parametrization of the totally nonnegative part of the rational unipotent loop
group of GL_n.