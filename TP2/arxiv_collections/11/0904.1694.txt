We address security of the quantum key distribution scheme based on the noisy
modulation of coherent states and investigate how it is robust against noise in
the modulation regardless of the particular technical implementation. As the
trusted preparation noise is shown to be security breaking even for purely
lossy channels, we reveal the essential difference between two types of trusted
noise, namely sender-side preparation noise and receiver-side detection noise,
the latter being security preserving. We consider the method of sender-side
state purification to compensate the preparation noise and show its
applicability in the realistic conditions of channel loss, untrusted channel
excess noise, and trusted detection noise. We show that purification makes the
scheme robust to the preparation noise (i.e., even the arbitrary noisy coherent
states can in principle be used for the purpose of quantum key distribution).
We also take into account the effect of realistic reconciliation and show that
the purification method is still efficient in this case up to a limited value
of preparation noise.