Quantum entropy function is a proposal for computing the entropy associated
with the horizon of a black hole in the extremal limit, and is related via
AdS/CFT correspondence to the dimension of the Hilbert space in a dual quantum
mechanics. We show that in N=4 supersymmetric string theories, quantum entropy
function formalism naturally explains the origin of the subtle differences
between the microscopic degeneracies of quarter BPS dyons carrying different
torsion, i.e. different arithmetical properties. These arise from additional
saddle points in the path integral -- whose existence depends on the
arithmetical properties of the black hole charges -- constructed as freely
acting orbifolds of the original AdS_2\times S^2 near horizon geometry. During
this analysis we demonstrate that the quantum entropy function is insensitive
to the details of the infrared cutoff used in the computation, and the details
of the boundary terms added to the action. We also discuss the role of the
asymptotic symmetries of AdS_2 in carrying out the path integral in the
definition of quantum entropy function. Finally we show that even though
quantum entropy function is expected to compute the absolute degeneracy in a
given charge and angular momentum sector, it can also be used to compute the
index. This can then be compared with the microscopic computation of the index.