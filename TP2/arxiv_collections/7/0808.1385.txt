A highly attenuated laser pulse which gives a weak coherent state is widely
used in quantum key distribution (QKD) experiments. A weak coherent state has
multi-photon components, which opens up a security loophole to the
sophisticated eavesdropper. With a small adjustment of the hardware, we prove
that the decoy state method can close this loophole and substantially improve
the QKD performance. We also propose a few practical decoy state protocols,
study statistical fluctuations and perform experimental demonstrations.
Moreover, we apply the methods from entanglement distillation protocols based
on two-way classical communication to improve the decoy state QKD performance.
Furthermore, we study the decoy state methods for other single photon sources,
such as triggering parametric down-conversion (PDC) source.
  We propose a model and post-processing scheme for the entanglement-based QKD
with a PDC source. Although the model is proposed to study the
entanglement-based QKD, we emphasize that our generic model may also be useful
for other non-QKD experiments involving a PDC source. By simulating a real PDC
experiment, we show that the entanglement-based QKD can achieve longer maximal
secure distance than the single-photon-based QKD schemes.
  We present a time-shift attack that exploits the efficiency mismatch of two
single photon detectors in a QKD system. This eavesdropping strategy can be
realized by current technology. We also discuss counter measures against the
attack and study the security of a QKD system with efficiency mismatch
detectors.