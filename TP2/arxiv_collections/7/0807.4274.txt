We develop a new extended version of the mode-coupling theory (MCT) for glass
transition, which incorporates activated hopping processes via the dynamical
theory originally formulated to describe diffusion-jump processes in crystals.
The dynamical-theory approach adapted here to glass-forming liquids treats
hopping as arising from vibrational fluctuations in quasi-arrested state where
particles are trapped inside their cages, and the hopping rate is formulated in
terms of the Debye-Waller factors characterizing the structure of the
quasi-arrested state. The resulting expression for the hopping rate takes an
activated form, and the barrier height for the hopping is ``self-generated'' in
the sense that it is present only in those states where the dynamics exhibits a
well defined plateau. It is discussed how such a hopping rate can be
incorporated into MCT so that the sharp nonergodic transition predicted by the
idealized version of the theory is replaced by a rapid but smooth crossover. We
then show that the developed theory accounts for the breakdown of the
Stokes-Einstein relation observed in a variety of fragile glass formers. It is
also demonstrated that characteristic features of dynamical heterogeneities
revealed by recent computer simulations are reproduced by the theory. More
specifically, a substantial increase of the non-Gaussian parameter, double-peak
structure in the probability distribution of particle displacements, and the
presence of a growing dynamic length scale are predicted by the extended MCT
developed here, which the idealized version of the theory failed to reproduce.
These results of the theory are demonstrated for a model of the Lennard-Jones
system, and are compared with related computer-simulation results and
experimental data.