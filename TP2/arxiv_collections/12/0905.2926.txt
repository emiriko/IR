Constant Proportion Portfolio Insurance (CPPI) is an investment strategy
designed to give participation in the performance of a risky asset while
protecting the invested capital. This protection is however not perfect and the
gap risk must be quantified. CPPI strategies are path-dependent and may have
American exercise which makes their valuation complex. A naive description of
the state of the portfolio would involve three or even four variables. In this
paper we prove that the system can be described as a discrete-time Markov
process in one single variable if the underlying asset follows a homogeneous
process. This yields an efficient pricing scheme using transition
probabilities. Our framework is flexible enough to handle most features of
traded CPPIs including profit lock-in and other kinds of strategies with
discrete-time reallocation.