We present a galaxy evolution model which incorporates a physically motivated
implementation of AGN feedback. Intermittent jets inflate cocoons of radio
plasma which then expand supersonically, shock heating the ambient gas. The
model reproduces observed star formation histories to the highest redshifts for
which reliable data exists, as well as the observed galaxy colour bimodality.
Intermittent radio source feedback also naturally provides a way of keeping the
black hole and spheroid growth in step. We find possible evidence for a
top-heavy Initial Mass Function (IMF) for $z>2$, consistent with observations
of element abundances, and sub-mm and Lyman break galaxy counts.