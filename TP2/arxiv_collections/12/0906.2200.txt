We present a detailed analysis of the extremely luminous Type IIn supernova
SN2006gy using spectra obtained between days 36 and 237 after explosion. We
derive the temporal evolution of the effective temperature, radius, expansion
speeds, and bolometric luminosity, as well as the progenitor wind density and
total swept-up mass overtaken by the shock. SN2006gy can be interpreted in the
context of shock interaction with a dense CSM, but with quite extreme values
for the CSM mass of 20 Msun and an explosion kinetic energy of at least 5e51
erg. A key difference between SN2006gy and other SNeIIn is that, owing to its
large CSM mass, the interaction region remained opaque much longer. At early
times, H-alpha widths suggest that the photosphere is ahead of the shock, and
photons diffuse out through the opaque CSM. The pivotal transition to optically
thin emission begins around day 110, when we start to see a decrease in the
blackbody radius and strengthening tracers of the post-shock shell. From the
evolution of pre-shock velocities, we deduce that the CSM was ejected by the
progenitor in a 1e49 erg precursor event 8yr before explosion. The large CSM
mass rules out models involving stars with initial masses around 10Msun. With
the full mass budget, even massive M_ZAMS=30-40 Msun progenitor stars are
inadequate. At roughly solar metallicity, substantial mass loss probably
occurred during the star's life, so SN 2006gy's progenitor is more consistent
with LBV eruptions or pulsational pair-instability ejections in stars with
initial masses above 100 Msun. This requires significant revision to current
paradigms of massive-star evolution. (abridged)