We use a recently improved density-matrix expansion to calculate the nuclear
energy density functional in the framework of in-medium chiral perturbation
theory. Our calculation treats systematically the effects from $1\pi$-exchange,
iterated $1\pi$-exchange, and irreducible $2\pi$-exchange with intermediate
$\Delta$-isobar excitations, including Pauli-blocking corrections up to
three-loop order. We find that the effective nucleon mass $M^*(\rho)$ entering
the energy density functional is identical to the one of Fermi-liquid theory
when employing the improved density-matrix expansion. The strength
$F_\nabla(\rho)$ of the $(\vec\nabla \rho)^2$ surface-term as provided by the
pion-exchange dynamics is in good agreement with that of phenomenological
Skyrme forces in the density region $\rho_0/2 <\rho <\rho_0$. The spin-orbit
coupling strength $F_{so}(\rho)$ receives contributions from iterated
$1\pi$-exchange (of the ``wrong sign'') and from three-nucleon interactions
mediated by $2\pi$-exchange with virtual $\Delta$-excitation (of the ``correct
sign''). In the region around $\rho_0/2 \simeq 0.08 $fm$^{-3}$ where the
spin-orbit interaction in nuclei gains most of its weight these two components
tend to cancel, thus leaving all room for the short-range spin-orbit
interaction. The strength function $F_J(\rho)$ multiplying the square of the
spin-orbit density comes out much larger than in phenomenological Skyrme forces
and it has a pronounced density dependence.