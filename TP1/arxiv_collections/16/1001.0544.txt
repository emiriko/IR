Given a flat meromorphic connection on an excellent scheme over a field of
characteristic zero, we prove existence of good formal structures after blowing
up; this extends a theorem of Mochizuki for algebraic varieties. The argument
combines a numerical criterion for good formal structures from a previous
paper, with an analysis based on the geometry of an associated valuation space
(Riemann-Zariski space). We obtain a similar result over the formal completion
of an excellent scheme along a closed subscheme. If we replace the excellent
scheme by a complex analytic variety, we obtain a similar but weaker result in
which the blowup can only be constructed in a small neighborhood of a
prescribed point.