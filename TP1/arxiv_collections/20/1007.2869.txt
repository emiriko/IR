Fault-tolerant quantum computation using quantum error-correcting codes
requires fault-tolerant constructions of nontransversal gates. Shor proposed a
fault-tolerant construction of a nontransversal gate, i.e., the Toffoli gate
for a family of the Calderbank-Shor-Steane codes which has even-weight
stabilizer generators and odd-weight logical operators. In fact, as shown in
this paper, error propagations in the ancilla preparation of Shor's
construction lead to logical errors. This work provides a solution to this
problem through the insertion of bit flip error correction. Finally, error
rates of a modified construction are evaluated with use of the concatenated
Steane codes, and the same accuracy threshold as transversal gates is obtained
in cases where ancillary systems can be prepared just in time.