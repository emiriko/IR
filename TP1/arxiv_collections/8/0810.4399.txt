We use a diagrammatic hopping expansion to calculate finite-temperature Green
functions of the Bose-Hubbard model which describes bosons in an optical
lattice. This technique allows for a summation of subsets of diagrams, so the
divergence of the Green function leads to non-perturbative results for the
boundary between the superfluid and the Mott phase for finite temperatures.
Whereas the first-order calculation reproduces the seminal mean-field result,
the second order goes beyond and shifts the phase boundary in the immediate
vicinity of the critical parameters determined by the latest high-precision
Monte-Carlo simulations of the Bose-Hubbard model. In addition, our Green's
function approach allows for calculating the excitation spectrum at finite
temperature and for determining the effective masses of particles and holes.