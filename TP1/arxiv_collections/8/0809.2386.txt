On finite structures, there is a well-known connection between the expressive
power of Datalog, finite variable logics, the existential pebble game, and
bounded hypertree duality. We study this connection for infinite structures.
This has applications for constraint satisfaction with infinite templates. If
the template Gamma is omega-categorical, we present various equivalent
characterizations of those Gamma such that the constraint satisfaction problem
(CSP) for Gamma can be solved by a Datalog program. We also show that
CSP(Gamma) can be solved in polynomial time for arbitrary omega-categorical
structures Gamma if the input is restricted to instances of bounded treewidth.
Finally, we characterize those omega-categorical templates whose CSP has
Datalog width 1, and those whose CSP has strict Datalog width k.