In this paper we study the moduli space of representations of a surface group
(i.e., the fundamental group of a closed oriented surface) in the real
symplectic group Sp(2n,R). The moduli space is partitioned by an integer
invariant, called the Toledo invariant. This invariant is bounded by a
Milnor-Wood type inequality. Our main result is a count of the number of
connected components of the moduli space of maximal representations, i.e.
representations with maximal Toledo invariant. Our approach uses the
non-abelian Hodge theory correspondence proved in a companion paper
arXiv:0909.4487 [math.DG] to identify the space of representations with the
moduli space of polystable Sp(2n,R)-Higgs bundles. A key step is provided by
the discovery of new discrete invariants of maximal representations. These new
invariants arise from an identification, in the maximal case, of the moduli
space of Sp(2n,R)-Higgs bundles with a moduli space of twisted Higgs bundles
for the group GL(n,R).