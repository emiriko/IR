The Trojan Horse method is a powerful indirect technique that provides
information to determine astrophysical factors for binary rearrangement
processes $x + A \to b + B$ at astrophysically relevant energies by measuring
the cross section for the Trojan Horse reaction $a + A \to y+ b + B$ in
quasi-free kinematics. We present the theory of the Trojan Horse method for
resonant binary subreactions based on the half-off-energy-shell R matrix
approach which takes into account the off-energy-shell effects and initial and
final state interactions.