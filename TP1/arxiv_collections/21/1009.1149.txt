We investigate the 21 cm absorption lines produced by non-linear structures
during the early stage of reionization, i.e. the starless minihalos and the
dwarf galaxies. After a detailed modelling of their properties, with particular
attention to the coupling physics, we determine their 21 cm absorption line
profiles. The infalling gas velocity around minihalos/dwarf galaxies strongly
affects the line shape, and with the low spin temperatures outside the virial
radii of the systems, gives rise to horn-like line profiles. The optical depth
of a dwarf galaxy is reduced for lines of sight penetrating through its HII
region, and especially, a large HII region created by a dwarf galaxy with
higher stellar mass and/or a top-heavy initial mass function results in an
optical depth trough rather than an absorption line. We compute synthetic
spectra of 21 cm forest for both high redshift quasars and radio afterglows of
gamma ray bursts (GRBs). Even with the planned SKA, radio afterglows of most if
not all GRBs would still be too dim to be the background sources for high
resolution (1 kHz) observations, but absorption lines can be easily detected
towards a high-z quasar. Broadband observation against GRB afterglows can also
be used to reveal the evolving 21 cm signal from both minihalos and dwarf
galaxies if there was no X-ray background or it was extremely weak, but it
becomes difficult if an early X-ray background existed. Hence the 21 cm
absorption could be a powerful probe of the presence/intensity of the X-ray
background and the thermal history of the early universe.