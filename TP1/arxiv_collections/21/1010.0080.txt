We study an optimal consumption and investment problem in a possibly
incomplete market with general, not necessarily convex, stochastic constraints.
We give explicit solutions for investors with exponential, logarithmic and
power utility. Our approach is based on martingale methods which rely on recent
results on the existence and uniqueness of solutions to BSDEs with drivers of
quadratic growth.