We run very large cosmological N-body hydrodynamical simulations in order to
study statistically the baryon fractions in early dark matter halos. We
critically examine how differences in the initial conditions affect the gas
fraction in the redshift range z = 11--21. We test three different linear power
spectra for the initial conditions: (1) A complete heating model, which is our
fiducial model; this model follows the evolution of overdensities correctly,
according to Naoz & Barkana (2005), in particular including the spatial
variation of the speed of sound of the gas due to Compton heating from the CMB.
(2) An equal-{\delta} model, which assumes that the initial baryon fluctuations
are equal to those of the dark matter, while conserving sigma8 of the total
matter. (3) A mean cs model, which assumes a uniform speed of sound of the gas.
The latter two models are often used in the literature. We calculate the baryon
fractions for a large sample of halos in our simulations. Our fiducial model
implies that before reionization and significant stellar heating took place,
the minimum mass needed for a minihalo to keep most of its baryons throughout
its formation was ~ 3 * 10^4 Msun. However, the alternative models yield a
wrong (higher by about 50%) minimum mass, since the system retains a memory of
the initial conditions. We also demonstrate this using the "filtering mass"
from linear theory, which accurately describes the evolution of the baryon
fraction throughout the simulated redshift range.