Even though the dark-matter power spectrum in the absence of biasing predicts
a number density of halos n(M) ~ M^-2 (i.e. a Schechter alpha value of -2) at
the low-mass end (M < 10^10 M_solar), hydrodynamic simulations have typically
produced values for stellar systems in good agreement with the observed value
alpha ~ -1. We explain this with a simple physical argument and show that an
efficient external gas-heating mechanism (such as the UV background included in
all hydro codes) will produce a critical halo mass below which halos cannot
retain their gas and form stars. We test this conclusion with GADGET-2-based
simulations using various UV backgrounds, and for the first time we also
investigate the effect of an X-ray background. We show that at the present
epoch alpha is depends primarily on the mean gas temperature at the
star-formation epoch for low-mass systems (z <~ 3): with no background we find
alpha ~ -1.5, with UV only alpha ~ -1.0, and with UV and X-rays alpha ~ -0.75.
We find the critical final halo mass for star formation to be ~4x10^8 M_solar
with a UV background and ~7x10^8 M_solar with UV and X-rays.