Li et al. presented a protocol [Int. Journal of Quantum Information, Vol. 4,
No. 6 (2006) 899-906] for quantum key distribution based on entanglement
swapping. In this protocol they use random and certain bits to construct a
classical key and they claim that this key is secure. In our article we show
that the protocol by Li et al. is insecure presenting a new type of attack
strategy which gives an adversary full information about the key without being
detected. This strategy is based on entanglement swapping, too, and manages to
preserve the correlation between the measurement results of the legitimate
parties. Further we present a modified version of the protocol and show that it
is secure against this new attack strategy.