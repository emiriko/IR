Finite-field calculations in periodic insulators are technically and
conceptually challenging, due to fundamental problems in defining polarization
in extended solids. While significant progress has been made recently with the
establishment of techniques to fix the electric field E or the macroscopic
polarization P in first-principles calculations, both methods lack the ease of
use and conceptual clarity of standard zero-field calculations. Here we develop
a new formalism in which the electric displacement D, rather than E or P, is
the fundamental electrical variable. Fixing D has the intuitive interpretation
of imposing open-circuit electrical boundary conditions, which is particularly
useful in studying ferroelectric systems. Furthermore, the analogy to
open-circuit capacitors suggests an appealing reformulation in terms of free
charges and potentials, which dramatically simplifies the treatment of stresses
and strains. Using PbTiO3 as an example, we show that our technique allows full
control over the electrical variables within the density functional formalism.