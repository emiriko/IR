In 1999 Berry and Keating showed that a regularization of the 1D classical
Hamiltonian H = xp gives semiclassically the smooth counting function of the
Riemann zeros. In this paper we first generalize this result by considering a
phase space delimited by two boundary functions in position and momenta, which
induce a fluctuation term in the counting of energy levels. We next quantize
the xp Hamiltonian, adding an interaction term that depends on two wave
functions associated to the classical boundaries in phase space. The general
model is solved exactly, obtaining a continuum spectrum with discrete bound
states embbeded in it. We find the boundary wave functions, associated to the
Berry-Keating regularization, for which the average Riemann zeros become
resonances. A spectral realization of the Riemann zeros is achieved exploiting
the symmetry of the model under the exchange of position and momenta which is
related to the duality symmetry of the zeta function. The boundary wave
functions, giving rise to the Riemann zeros, are found using the Riemann-Siegel
formula of the zeta function. Other Dirichlet L-functions are shown to find a
natural realization in the model.