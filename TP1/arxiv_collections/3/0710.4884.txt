The Differential-Phase-Shift (DPS) and the Coherent-One-Way (COW) are among
the most practical protocols for quantum cryptography, and are therefore the
object of fast-paced experimental developments. The assessment of their
security is also a challenge for theorists: the existing tools, that allow to
prove security against the most general attacks, do not apply to these two
protocols in any straightforward way. We present new upper bounds for their
security in the limit of large distances ($d \gtrsim 50$km with typical values
in optical fibers) by considering a large class of collective attacks, namely
those in which the adversary attaches ancillary quantum systems to each pulse
or to each pair of pulses. We introduce also two modified versions of the COW
protocol, which may prove more robust than the original one.