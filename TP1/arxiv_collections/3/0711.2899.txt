Let L be a finite-dimensional simple Lie algebra over an algebraically closed
field of F characteristic p>3. We prove that if the p-envelope of L in the
derivation algebra of L contains nonstandard tori of maximal dimension, then
p=5 and L is isomorphic to one of the Melikian algebras. Together with our
earlier results this implies that any finite-dimensional simple Lie algebra
over F is of classical, Cartan or Melikian type.