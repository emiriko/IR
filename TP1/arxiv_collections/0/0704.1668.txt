Context. Searching for planets in open clusters allows us to study the
effects of dynamical environment on planet formation and evolution.
  Aims. Considering the strong dependence of planet frequency on stellar
metallicity, we studied the metal rich old open cluster NGC 6791 and searched
for close-in planets using the transit technique.
  Methods. A ten-night observational campaign was performed using the
Canada-France-Hawaii Telescope (3.6m), the San Pedro M\'artir telescope (2.1m),
and the Loiano telescope (1.5m). To increase the transit detection probability
we also made use of the Bruntt et al. (2003) eight-nights observational
campaign. Adequate photometric precision for the detection of planetary
transits was achieved.
  Results. Should the frequency and properties of close-in planets in NGC 6791
be similar to those orbiting field stars of similar metallicity, then detailed
simulations foresee the presence of 2-3 transiting planets. Instead, we do not
confirm the transit candidates proposed by Bruntt et al. (2003). The
probability that the null detection is simply due to chance coincidence is
estimated to be 3%-10%, depending on the metallicity assumed for the cluster.
  Conclusions. Possible explanations of the null-detection of transits include:
(i) a lower frequency of close-in planets in star clusters; (ii) a smaller
planetary radius for planets orbiting super metal rich stars; or (iii)
limitations in the basic assumptions. More extensive photometry with 3-4m class
telescopes is required to allow conclusive inferences about the frequency of
planets in NGC 6791.