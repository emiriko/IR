Let $f\colon M\to N$ be a continuous map between closed irreducible graph
manifolds with infinite fundamental group. Perron and Shalen showed that if $f$
induces a homology equivalence on all finite covers, then $f$ is in fact
homotopic to a homeomorphism. Their proof used the statement that every graph
manifold is finitely covered by a $3$-manifold whose fundamental group is
residually $p$ for every prime $p$. We will show that this statement regarding
graph manifold groups is not true in general, but we will show how to modify
the argument of Perron and Shalen to recover their main result. As a by-product
we will determine all semidirect products $\Z \ltimes \Z^d$ which are
residually $p$ for every prime $p$.