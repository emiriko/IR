We define a finite Markov chain, called generalized crested product, which
naturally appears as a generalization of the first crested product of Markov
chains. A complete spectral analysis is developed and the $k$-step transition
probability is given. It is important to remark that this Markov chain
describes a more general version of the classical Ehrenfest diffusion model. As
a particular case, one gets a generalization of the classical Insect Markov
chain defined on the ultrametric space. Finally, an interpretation in terms of
representation group theory is given, by showing the correspondence between the
spectral decomposition of the generalized crested product and the Gelfand pairs
associated with the generalized wreath product of permutation groups.