The self-consistent quasiparticle RPA (SCQRPA) is constructed to study the
effects of fluctuations on pairing properties in nuclei at finite temperature
and z-projection M of angular momentum. Particle-number projection (PNP) is
taken into account within the Lipkin-Nogami method. Several issues such as the
smoothing of superfluid-normal phase transition, thermally assisted pairing in
hot rotating nuclei, extraction of the nuclear pairing gap using an improved
odd-even mass difference are discussed. A novel approach of embedding the PNP
SCQRPA eigenvalues in the canonical and microcanonical ensembles is proposed
and applied to describe the recent empirical thermodynamic quantities for iron,
molybdenum, dysprosium, and ytterbium isotopes.