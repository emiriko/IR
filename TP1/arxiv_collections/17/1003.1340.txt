The most usual tracer of molecular gas is line emission from CO. However, the
reliability of that tracer has long been questioned in environments different
from the Milky Way. We study the relationship between H2 and CO abundances
using a fully dynamical model of magnetized turbulence coupled to a chemical
network simplified to follow only the dominant pathways for H2 and CO formation
and destruction, and including photodissociation using a six-ray approximation.
We find that the abundance of H2 is primarily determined by the amount of time
available for its formation, which is proportional to the product of the
density and the metallicity, but insensitive to photodissociation.
Photodissociation only becomes important at extinctions under a few tenths of a
visual magnitude, in agreement with both observational and prior theoretical
work. On the other hand, CO forms quickly, within a dynamical time, but its
abundance depends primarily on photodissociation, with only a weak secondary
dependence on H2 abundance. As a result, there is a sharp cutoff in CO
abundance at mean visual extinctions A_V < 3. At lower values of A_V we find
that the ratio of H2 column density to CO emissivity X_CO is proportional to
A_V^(-3.5). This explains the discrepancy observed in low metallicity systems
between cloud masses derived from CO observations and other techniques such as
infrared emission. Our work predicts that CO-bright clouds in low metallicity
systems should be systematically larger or denser than Milky Way clouds, or
both. Our results further explain the narrow range of observed molecular cloud
column densities as a threshold effect, without requiring the assumption of
virial equilibrium.