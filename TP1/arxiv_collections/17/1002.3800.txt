We prove $L^{p}$ and weighted $L^{p}$ estimates for bounded functions of a
selfadjoint operator satisfying both a pointwise gaussian estimate for its heat
kernel and a finite speed of propagation property. As an application, we obtain
weighted estimates for fractiional powers of an electromagnetic Schr\"odinger
operator with singular coefficienta. The proofs are based on a modification of
techniques due to Hebisch and Auscher and Martell. EDIT: second version,
November 2010, a few inaccuracies have been corrected.