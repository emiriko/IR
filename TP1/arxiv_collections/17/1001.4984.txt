We reconsider the ellipsoidal-collapse model and extend it in two ways: We
modify the treatment of the external gravitational shear field, introducing a
hybrid model in between linear and non-linear evolution, and we introduce a
virialisation criterion derived from the tensor virial theorem to replace the
ad-hoc criterion employed so far. We compute the collapse parameters delta_c
and Delta_v and find that they increase with ellipticity e and decrease with
prolaticity p. We marginalise them over the appropriate distribution of e and p
and show the marginalised results as functions of halo mass and virialisation
redshift. While the hybrid model for the external shear gives results very
similar to those obtained from the non-linear model, ellipsoidal collapse
changes the collapse parameters typically by (20...50)%, in a way increasing
with decreasing halo mass and decreasing virialisation redshift. We
qualitatively confirm the dependence on mass and virialisation redshift of a
fitting formula for delta_c, but find noticeable quantitative differences in
particular at low mass and high redshift. The derived mass function is in good
agreement with mass functions recently proposed in the literature.