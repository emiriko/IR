Since 1908, when Mie reported analytical expressions for the fields scattered
by a spherical particle upon incidence of an electromagnetic plane-wave,
generalizing his analysis to the case of an arbitrary incident wave has proved
elusive. This is due to the presence of certain radially-dependent terms in the
equation for the beam-shape coefficients of the expansion of the
electromagnetic fields in terms of vector spherical wave functions. Here we
show for the first time how these terms can be canceled out, allowing
analytical expressions for the beam shape coefficients to be found for a
completely arbitrary incident field. We give several examples of how this new
method, which is well suited to numerical calculation, can be used. Analytical
expressions are found for Bessel beams and the modes of rectangular and
cylindrical metallic waveguides. The results are highly relevant for speeding
up calculation of the radiation forces acting on small spherical particles
placed in an arbitrary electromagnetic field, for example in optical tweezers.