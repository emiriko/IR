One of the simplest security proofs of quantum key distribution is based on
the so-called complementarity scenario, which involves the complementarity
control of an actual protocol and a virtual protocol [M. Koashi, e-print
arXiv:0704.3661 (2007)]. The existing virtual protocol has a limitation in
classical postprocessing, i.e., the syndrome for the error-correction step has
to be encrypted. In this paper, we remove this limitation by constructing a
quantum circuit for the virtual protocol. Moreover, our circuit with a shield
system gives an intuitive proof of why adding noise to the sifted key increases
the bit error rate threshold in the general case in which one of the parties
does not possess a qubit. Thus, our circuit bridges the simple proof and the
use of wider classes of classical postprocessing.