We study a zero-range process where the jump rates do not only depend on the
local particle configuration, but also on the size of the system. Rigorous
results on the equivalence of ensembles are presented, characterizing the
occurrence of a condensation transition. In contrast to previous results, the
phase transition is discontinuous and the system exhibits ergodicity breaking
and metastable phases. This leads to a richer phase diagram, including
nonequivalence of ensembles in certain phase regions. The paper is motivated by
results from granular clustering, where these features have been observed
experimentally.