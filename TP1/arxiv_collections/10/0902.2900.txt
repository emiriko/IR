A new code called VAAQP (Variational Average-Atom in Quantum Plasmas) is
reported. The model as well as main results of previous studies are briefly
recalled. The code is based on a new fully variational model of dense plasmas
at equilibrium with quantum treatment of all electrons. The code can calculate
the Average Atom structure and the mean ionization from the variational
equations respecting the virial theorem and without imposing the neutrality of
the Wigner-Seitz sphere. The formula obtained for the electronic pressure is
simple and does not require any numerical differentiation. A description of the
principal features of the code is given. The thermodynamic consistency of the
results obtained with VAAQP is shown by a comparison with another approach on
the example of the aluminium 10 eV isotherm EOS curve. A first comparison to an
INFERNO-type model is also presented.