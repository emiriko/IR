The origin of ultra-intense magnetic fields on magnetars is a mystery in
modern astrophysics. We model the core collapse dynamics of massive progenitor
stars with high surface magnetic fields in the theoretical framework of a
self-similar general polytropic magnetofluid under the self-gravity with a
quasi-spherical symmetry. With the specification of physical parameters such as
mass density, temperature, magnetic field and wind mass loss rate on the
progenitor stellar surface and the consideration of a rebound shock breaking
through the stellar interior and envelope, we find a remnant compact object
(i.e. neutron star) left behind at the centre with a radius of $\sim 10^6$ cm
and a mass range of $\sim 1-3$ solar masses. Moreover, we find that surface
magnetic fields of such kind of compact objects can be $\sim 10^{14}-10^{15}$
G, consistent with those inferred for magnetars which include soft gamma-ray
repeaters (SGRs) and anomalous X-ray pulsars (AXPs). The magnetic field
enhancement factor critically depends on the self-similar scaling index $n$,
which also determines the initial density distribution of the massive
progenitor. We propose that magnetized massive stars as magnetar progenitors
based on the magnetohydrodynamic evolution of the gravitational core collapse
and rebound shock. Our physical mechanism, which does not necessarily require
ad hoc dynamo amplification within a fast spinning neutron star, favours the
`fossil field' scenario of forming magnetars from the strongly magnetized core
collapse inside massive progenitor stars. With a range of surface magnetic
field strengths over massive progenitor stars, our scenario allows a continuum
of magnetic field strengths from pulsars to magnetars.