We derive a new estimate of the size of finite sets of points in metric
spaces with few distances. The following applications are considered:
  (1) we improve the Ray-Chaudhuri--Wilson bound of the size of uniform
intersecting families of subsets;
  (2) we refine the bound of Delsarte-Goethals-Seidel on the maximum size of
spherical sets with few distances;
  (3) we prove a new bound on codes with few distances in the Hamming space,
improving an earlier result of Delsarte.
  We also find the size of maximal binary codes and maximal constant-weight
codes of small length with 2 and 3 distances.