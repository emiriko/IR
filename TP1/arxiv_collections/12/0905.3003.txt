The numerical kernel approach to difference imaging has been implemented and
applied to gravitational microlensing events observed by the PLANET
collaboration. The effect of an error in the source-star coordinates is
explored and a new algorithm is presented for determining the precise
coordinates of the microlens in blended events, essential for accurate
photometry of difference images. It is shown how the photometric reference flux
need not be measured directly from the reference image but can be obtained from
measurements of the difference images combined with knowledge of the
statistical flux uncertainties. The improved performance of the new algorithm,
relative to ISIS2, is demonstrated.