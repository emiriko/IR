We compute in detail the rate at which energy injected by dark matter
annihilation heats and ionizes the photon-baryon plasma at z ~ 1000, and
provide accurate fitting functions over the relevant redshift range for a broad
array of annihilation channels and DM masses. The resulting perturbations to
the ionization history can be constrained by measurements of the CMB
temperature and polarization angular power spectra. We show that models which
fit recently measured excesses in 10-1000 GeV electron and positron cosmic rays
are already close to the 95% confidence limits from WMAP. The recently launched
Planck satellite will be capable of ruling out a wide range of DM explanations
for these excesses. In models of dark matter with Sommerfeld-enhanced
annihilation, where sigma v rises with decreasing WIMP velocity until some
saturation point, the WMAP5 constraints imply that the enhancement must be
close to saturation in the neighborhood of the Earth.