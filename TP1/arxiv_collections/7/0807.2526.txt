This paper presents a stochastic model for discrete-time trading in financial
markets where trading costs are given by convex cost functions and portfolios
are constrained by convex sets. The model does not assume the existence of a
cash account/numeraire. In addition to classical frictionless markets and
markets with transaction costs or bid-ask spreads, our framework covers markets
with nonlinear illiquidity effects for large instantaneous trades. In the
presence of nonlinearities, the classical notion of arbitrage turns out to have
two equally meaningful generalizations, a marginal and a scalable one. We study
their relations to state price deflators by analyzing two auxiliary market
models describing the local and global behavior of the cost functions and
constraints.