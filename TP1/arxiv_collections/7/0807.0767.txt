We consider the security of the Bennett-Brassard 1984 (BB84) protocol for
Quantum Key Distribution (QKD), in the presence of bit and basis dependent
detector flaws. We suggest a powerful attack that can be used in systems with
detector efficiency mismatch, even if the detector assignments are chosen
randomly by Bob. A security proof is provided, valid for any basis dependent,
possibly lossy, linear optical imperfections in the channel/receiver/detectors.
The proof does not assume the so-called squashing detector model.