Photon number resolving detectors can enhance the performance of many
practical quantum cryptographic setups. In this paper, we employ a simple
method to estimate the statistics provided by such a photon number resolving
detector using only a threshold detector together with a variable attenuator.
This idea is similar in spirit to that of the decoy state technique, and is
specially suited for those scenarios where only a few parameters of the photon
number statistics of the incoming signals have to be estimated. As an
illustration of the potential applicability of the method in quantum
communication protocols, we use it to prove security of an entanglement based
quantum key distribution scheme with an untrusted source without the need of a
squash model and by solely using this extra idea. In this sense, this detector
decoy method can be seen as a different conceptual approach to adapt a single
photon security proof to its physical, full optical implementation. We show
that in this scenario the legitimate users can now even discard the double
click events from the raw key data without compromising the security of the
scheme, and we present simulations on the performance of the BB84 and the
6-state quantum key distribution protocols.