The origin of prompt emission in GRBs is not yet well understood. The
simplest and most popular model is Synchrotron, Self-Compton (SSC) emission
produced by internal shocks inside an ultra-relativistic jet. However, recent
observations of a delayed high energy component have encouraged alternative
models. Here we use a recently developed formulation of relativistic shocks to
simulate GRBs. It takes into account the evolution of quantities such as
densities of colliding shells, electric and magnetic fields. We also extend the
previous formulation by considering a precessing external magnetic field. These
simulations are very realistic and present significant improvement with respect
to previous phenomenological GRB simulations. They reproduce light curves of
separated peaks of real GRBs and variety of observed spectral slopes at E >
E_{peak}. The high energy emission can be explained by synchrotron emission and
a subdominant contribution from inverse Compton. We also suggest an explanation
for the extended tail emission observed by the Fermi-LAT instrument and relate
it to the screening of the magnetic field and/or trapping of accelerated
electrons in the electromagnetic energy structure of the plasma in the shock
front. Spectral slopes of simulated bursts at E << E_{peak} are consistent with
theoretical prediction and at E < E_{peak} can be flatter if the spectrum of
electrons is roughly flat or has a shallow slope. The observed flat spectra at
soft gamma-ray and hard x-ray bands is the evidence that there is a significant
contribution at $E < E_{peak}$ from lower Lorentz factor wing of electrons
distribution which have a roughly random acceleration rather than being
thermal. This means that the state of matter in the jet at the time of ejection
is most probably nonthermal and electrons have a shallow spectrum at low
energies.(abbreviated)