We extend the descent theory of Colliot-Th\'el\`ene and Sansuc to arbitrary
smooth algebraic varieties by removing the condition that every invertible
regular function is constant. This links the Brauer--Manin obstruction for
integral points on arithmetic schemes to the obstructions defined by torsors
under groups of multiplicative type.