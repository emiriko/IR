We classify all possible implementations of an abelian symmetry in the
two-Higgs-doublet model with fermions. We identify those symmetries which are
consistent with non-vanishing quark masses and a CKM matrix which is not
block-diagonal. Our analysis takes us from a plethora of possibilities down to
246 relevant cases, requiring only 34 distinct matrix forms. We show that
applying Z_n with n \geq 4 to the scalar sector leads to a continuous U(1)
symmetry in the whole Lagrangian. Finally, we address the possibilities of
spontaneous CP violation and of natural suppression of the flavour changing
neutral currents. We explain why our work is relevant even for non-abelian
symmetries.