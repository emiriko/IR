In this work we derive a general formula for the charge pumped in a
superconducting nanocircuit. Our expression generalizes previous results in
several ways, it is applicable both in the adiabatic and in the non-adiabatic
regimes and it takes into account also the effect of an external environment.
More specifically, by applying Floquet theory to Cooper pair pumping, we show
that under a cyclic evolution the total charge transferred through the circuit
is proportional to the derivative of the associated Floquet quasi-energy with
respect to the superconducting phase difference. In the presence of an external
environment the expression for the transferred charge acquires a transparent
form in the Floquet representation. It is given by the weighted sum of the
charge transferred in each Floquet state, the weights being the diagonal
components of the stationary density matrix of the system expressed in the
Floquet basis. In order to test the power of this formulation we apply it to
the study of pumping in a Cooper pair sluice. We reproduce the known results in
the adiabatic regime and we show new data in the non-adiabatic case.