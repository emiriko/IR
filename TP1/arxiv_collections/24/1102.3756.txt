We investigate the p-spin model with Gaussian-distributed random interactions
in the microcanonical ensemble using the replica theory. For p=2, there are
only second-order phase transitions and we recover the results of Sherrington
and Kirkpatrick obtained in the canonical ensemble. For p > 2, the transition
between the ferromagnetic and paramagnetic phases is of first order, and the
microcanonical and canonical ensembles give different results. We also discuss
the ensemble inequivalence of the random energy model, corresponding to the
limit p => infinity. This is the first systematic treatment of spin glasses
with long-range interactions in the microcanonical ensemble, which shows how
the two ensembles give different results.