A mechanism for proton acceleration to ~10^21eV is suggested. It may operate
in accretion flows onto thin dark matter filaments of cosmic structure
formation. The flow compresses the ambient magnetic field to strongly increase
and align it with the filament. Particles begin the acceleration by the ExB
drift with the accretion flow. The energy gain in the drift regime is limited
by the conservation of the adiabatic invariant p_perp^2/B. Upon approaching the
filament, the drift turns into the gyro-motion around the filament so that the
particle moves parallel to the azimuthal electric field. In this 'betatron'
regime the acceleration speeds up to rapidly reach the electrodynamic limit
$cp_{max}=eBR$ for an accelerator with magnetic field $B$ and the orbit radius
$R$ (Larmor radius). The periodic orbit becomes unstable and the particle
slings out of the filament to the region of a weak (uncompressed) magnetic
field, which terminates the acceleration.
  The mechanism requires pre-acceleration that is likely to occur in structure
formation shocks upstream or nearby the filament accretion flow. Previous
studies identify such shocks as efficient proton accelerators to a firm upper
limit ~10^19.5 eV placed by the catastrophic photo-pion losses. The present
mechanism combines explosive energy gain in its final (betatron) phase with
prompt particle release from the region of strong magnetic field. It is this
combination that allows protons to overcome both the photo-pion and the
synchrotron-Compton losses and therefore attain energy 10^21 eV. A requirement
on accelerator to reach a given E_max placed by the accelerator energy
dissipation \propto E_{max}^{2}/Z_0 due to the finite vacuum impedance Z_0 is
circumvented by the cyclic operation of the accelerator.