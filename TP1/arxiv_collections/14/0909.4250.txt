Let $\pi:X\to Y$ be a factor map, where $(X,\sigma_X)$ and $(Y,\sigma_Y)$ are
subshifts over finite alphabets. Assume that $X$ satisfies weak specification.
Let $\ba=(a_1,a_2)\in \R^2$ with $a_1>0$ and $a_2\geq 0$. Let $f$ be a
continuous function on $X$ with sufficient regularity (H\"{o}lder continuity,
for instance). We show that there is a unique shift invariant measure $\mu$ on
$X$ that maximizes $\mu(f)+a_1h_\mu(\sigma_X)+ a_2h_{\mu\circ
\pi^{-1}}(\sigma_Y)$. In particular, taking $f\equiv 0$ we see that there is a
unique invariant measure $\mu$ on $X$ that maximizes the weighted entropy
$a_1h_\mu(\sigma_X)+ a_2h_{\mu\circ \pi^{-1}}(\sigma_Y)$. This answers an open
question raised by Gatzouras and Peres in \cite{GaPe96}. An extension is also
given to high dimensional cases. As an application, we show the uniqueness of
invariant measures with full Hausdorff dimension for certain affine invariant
sets on the $k$-torus under a diagonal endomorphism.