The vast majority of RFID authentication protocols assume the proximity
between readers and tags due to the limited range of the radio channel.
However, in real scenarios an intruder can be located between the prover (tag)
and the verifier (reader) and trick this last one into thinking that the prover
is in close proximity. This attack is generally known as a relay attack in
which scope distance fraud, mafia fraud and terrorist attacks are included.
Distance bounding protocols represent a promising countermeasure to hinder
relay attacks. Several protocols have been proposed during the last years but
vulnerabilities of major or minor relevance have been identified in most of
them. In 2008, Kim et al. [1] proposed a new distance bounding protocol with
the objective of being the best in terms of security, privacy, tag
computational overhead and fault tolerance. In this paper, we analyze this
protocol and we present a passive full disclosure attack, which allows an
adversary to discover the long-term secret key of the tag. The presented attack
is very relevant, since no security objectives are met in Kim et al.'s
protocol. Then, design guidelines are introduced with the aim of facilitating
protocol designers the stimulating task of designing secure and efficient
schemes against relay attacks. Finally a new protocol, named Hitomi and
inspired by [1], is designed conforming the guidelines proposed previously.