In this paper, we develop a quantum key distribution protocol based on the
Greenberger-Horne-Zeilinger states (GHZs). The particles are exchanged among
the users in blocks through two steps. In this protocol, for three-particle
GHZs three keys can be simultaneously generated. The advantage of this is that
the users can select the most suitable key for communication. The protocol can
be generalized to $N$ users to provide $N$ keys. The protocol has two levels
for checking the eavesdroppers. Moreover, we discuss the security of the
protocol against different attacks.